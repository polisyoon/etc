{
    "content": "import os\nimport pymysql\nimport json\nfrom dotenv import load_dotenv\n\n# Load environment variables\nload_dotenv()\n\n# Connect to the database\ncnx = pymysql.connect(\n    host=os.getenv('DB_HOST'),\n    user=os.getenv('DB_USER'),\n    passwd=os.getenv('DB_PASSWD'),\n    db=os.getenv('DB_NAME'),\n    cursorclass=pymysql.cursors.DictCursor,\n    use_unicode=True,\n    charset=os.getenv('DB_CHARSET')\n)\n\ntry:\n    # Prepare a cursor object using cursor() method\n    cursor = cnx.cursor()\n\n    # SQL query to execute\n    #querySelect = \"SELECT cg.*, e.*, s.*, r.*, rec.*, se.* FROM events e LEFT JOIN categories_general cg ON e.year = cg.year LEFT JOIN sessions s ON e.year = s.year LEFT JOIN results r ON e.year = r.year LEFT JOIN records rec ON e.year = rec.year LEFT JOIN seasons se ON e.year = se.year WHERE e.year = 2023 and e.id = 'a08837b6-1cfb-4dfe-a7a4-d61fe970ea3d';\"\n    #querySelect = \"SELECT cg.*, e.*, s.*, r.*, rec.*, se.* FROM events e LEFT JOIN categories_general cg ON e.year = cg.year LEFT JOIN sessions s ON e.year = s.year AND e.id = s.event_id LEFT JOIN results r ON e.year = r.year AND e.id = r.event_id LEFT JOIN records rec ON e.year = rec.year LEFT JOIN seasons se ON e.year = se.year WHERE e.year = 2023 AND e.id = 'a08837b6-1cfb-4dfe-a7a4-d61fe970ea3d';\"\n    querySelect = \"SELECT * FROM racingmike_motogp.results where year = 2023\"\n    # Execute the SQL command\n    cursor.execute(querySelect)\n\n    # Fetch all the rows in a list of lists.\n    result = cursor.fetchall()\n    print(result)\n\n    # Write result to a JSON file\n    with open('result.json', 'w') as json_file:\n        json.dump(result, json_file, indent=4, default=str)\n\n    print(\"Data saved to result.json\")\n\nfinally:\n    # disconnect from server\n    cnx.close()\n"
}